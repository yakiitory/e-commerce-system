{% extends "base.html" %}

{% block head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/merchant-dashboard.css') }}">
<title>Merchant Dashboard</title>
{% endblock %}

<main class="content-wrapper">
{% block body %}
    <div class="dashboard-container">
        <h3>{{ current_user.store_name }} Dashboard</h3>
        <div class="dashboard-grid">
            <div class="dashboard-card">
                <h4>Manage Orders</h4>
                <p>View and process incoming customer orders.</p>
                <a href="{{ url_for('merchant_orders_page') }}" class="card-link">Go to Orders</a>
            </div>
            <div class="dashboard-card">
                <h4>Manage Products</h4>
                <p>Add, edit, or remove your product listings.</p>
                <a href="#product-list-section" class="card-link">Go to Products</a>
            </div>
        </div>

        <div id="product-list-section" class="product-list-section">
            <div class="dashboard-header">
                <h4>Your Products</h4>
                <a href="{{ url_for('add_product_page') }}" class="add-product-btn">Add New Product</a>
            </div>
            <div class="product-list">
                {% if products %}
                <table class="product-table">
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Brand</th>
                            <th>Price</th>
                            <th>Stock</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for product in products %}
                        <tr>
                            <td>{{ product.name }}</td>
                            <td>{{ product.brand }}</td>
                            <td>â‚±{{ "{:,.2f}".format(product.price) }}</td>
                            <td>{{ product.quantity_available }}</td>
                            <td class="action-cell">
                                <a href="{{ url_for('edit_product_page', product_id=product.product_id) }}" class="action-btn">Edit</a>
                                <form action="{{ url_for('delete_product', product_id=product.product_id) }}" method="post" onsubmit="return confirm('Are you sure you want to delete this product? This action cannot be undone.');">
                                    <button type="submit" class="action-btn delete-btn" title="Delete Product">
                                        {% include "svg/trash.svg" %}
                                    </button>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <p>You have not added any products yet. Click "Add New Product" to get started.</p>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
</main>
